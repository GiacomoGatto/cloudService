{% extends "applayout.html" %}

{% load filters %}

{% block body %}
    <div class="row first-row">
        <div class="col-md-12">
            <div class="container" style=""> 

                 <ul class="breadcrumbs">
                    <li><a href="/webapp/home">Start</a></li>
                    <li>Data</li>
                </ul>

            </div>
        </div>
    </div>



<!-- price & service -->
<div class="container">
                    
    <div class="col-md-2">
        <div class="row">
            <a href="/webapp/data/planets">Planets</a>
        </div>
        <div class="row">
            <a href="/webapp/data/missions">Missions</a>
        </div>    
        <div class="row">
            <a href="/webapp/data/components">Components</a>
        </div>
    </div>

{% if what|safe == 'planets' %}
    <div class="col-md-9">
        <div class="row">
            <p><h1>Solar System</h1></p>
        </div>
        {% for b in bodies|group_by:3 %}
            <div class="row first-row">
                {% for obj in b %}
                    <div class="col-md-3" id="home-box">
                        <div class="row first-row">
                            <div class="pricing_header">
                                <h2>{{obj.target.name}}</h2>
                            <div class="space"></div>
                            </div>
                        </div>
                        <div class="row first-row" style="margin-top:3px;">
                        <ul class="list-group">
                            <li class="list-group-item on"><span class="glyphicon glyphicon-ok"></span>Light: {{obj.light}}</li>
                            <li class="list-group-item on"><span class="glyphicon   glyphicon-ok"></span>Mass: {{obj.mass}}</li>
                            <li class="list-group-item on"><span class="glyphicon glyphicon-ok"></span>Diameter: {{obj.diameter}}</li>
                            <li class="list-group-item on"><span class="glyphicon glyphicon-ok"></span>Density: {{obj.density}}</li>
                            <li class="list-group-item on"><span class="glyphicon glyphicon-ok"></span>Gravity:{{obj.gravity}}</li>
                            <li class="list-group-item on"><span class="glyphicon glyphicon-ok"></span>L-Year: {{obj.l_year}}</li>
                        </ul>
                        
                        </div>
                        <div class="row first-row">      
                        <div class="try">
                            <p class="price"></p>
                            <a class="btn btn-default" href="/webapp/go/to/{{obj.target.slug}}" type="button">Try in Simulation</a>
                        </div>
                        </div>
                    </div>
                    {% endfor %}
            </div>
        {% endfor %}
        <div class="hr5" style="margin-top:40px; margin-bottom:40px;"></div>
    </div>
{% endif %}

{% if what|safe == 'missions'%}
    <div class="col-md-12">
        <div class="row">
            <p><h1>Missions</h1></p>
        </div>

        <div class="hr5" style="margin-top:40px; margin-bottom:40px;"></div>

        <!--
        <div class="row">
        <div class="col-md-3">
            <form action="#" method="get">
                <div class="input-group">
                    <input class="form-control" id="system-search" name="q" placeholder="Search for" required>
                    <span class="input-group-btn">
                        <button type="submit" class="btn btn-default"><i class="glyphicon glyphicon-search"></i></button>
                    </span>
                </div>
            </form>
        </div>
        </div>
        -->
        <div class="row first-row">
        <div class="col-md-12">
                <table class="table table-list-search">
                    <thead>
                        <tr>
                            <th>Image</th>
                            <th>Codename</th>
                            <th>Name</th>
                            <th>Target</th>
                            <th>Era</th>
                            <th>Agency</th>
                            <th>Launches</th>
                            <th>Twitter</th>
                            <th>FB</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for m in bodies %}
                        <tr>
                            <td><div style="width:200px;height:200px;margin: auto auto;"><img src="{{m.image_url}}" style="margin: auto auto;" class="media-object img-rounded img-responsive"/></div></td>
                            <td><a href="/webapp/data/missions/details/{{m.id}}/?page={{page}}">{{m.codename}}</a></td>
                            <td><a href="/webapp/data/missions/details/{{m.id}}/?page={{page}}">{{m.name}}</a></td>
                            <td><u>{{m.target.name}}</u></td>
                            <td>{{m.get_era_display}}</td>
                            <td>{% if m.nasa|safe = 'True' %}
                                    NASA&nbsp;
                                {% if m.esa|safe = 'True' %}
                                    ESA&nbsp;
                                {% if m.jaxa|safe = 'True' %}
                                   JAXA&nbsp;
                                {% endif %}
                            </td>
                            <td>
                            {% if m.launch_dates|safe != 'None' %}
                                {{m.launch_dates}}
                            {% endif %}
                            </td>
                             <td>
                            {% if m.twitter|safe != 'None' %}
                               {{m.twitter}}
                            {% endif %}
                            </td>
                            <td>
                            {% if m.fb_page|safe != 'None' %}
                                {{m.fb_page}}
                            {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
        </div>

         <div class="hr5" style="margin-top:40px; margin-bottom:40px;"></div>
    </div>

    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-11">
            <ul class="pagination pagination-lg">
                {% if bodies.has_previous %}
                    <li><a href="?page={{ bodies.previous_page_number }}">previous</a></li>
                {% endif %}
                {% if bodies.number > 4 %}
                <li><a href="?page={{ bodies.number|add:"-4"}}">{{bodies.number|add:"-4" }}</a></li>
                <li><a href="?page={{ bodies.number|add:"-3"}}">{{ bodies.number|add:"-3" }}</a></li>
                <li><a href="?page={{ bodies.number|add:"-2"}}">{{ bodies.number|add:"-2"}}</a></li>
                <li><a href="?page={{ bodies.number|add:"-1"}}">{{ bodies.number|add:"-1" }}</a></li>
                {% endif %}

                <li><span class="current">
                    Page {{ bodies.number }} of {{ bodies.paginator.num_pages }}.
                </span></li>

                {% if bodies.number <  bodies.paginator.num_pages|add:"-4" %}
                <li><a href="?page={{ bodies.number|add:1 }}">{{ bodies.number|add:1 }}</a></li>
                <li><a href="?page={{ bodies.number|add:2 }}">{{ bodies.number|add:2 }}</a></li>
                <li><a href="?page={{ bodies.number|add:3 }}">{{ bodies.number|add:3 }}</a></li>
                <li><a href="?page={{ bodies.number|add:4 }}">{{ bodies.number|add:4 }}</a></li>
                {% endif %}
                {% if bodies.has_next %}
                    <li><a href="?page={{ bodies.next_page_number }}">next</a></li>
                {% endif %}
            </ul>
        </div>
    </div>
</div>
{% endif %}

{% if what|safe == 'components'%}
    <div class="col-md-9">
        <div class="row">
            <p><h1>Components</h1></p>
        </div>

        <div class="hr5" style="margin-top:40px; margin-bottom:40px;"></div>

    
        <div class="row">
        <div class="col-md-3">
            <form action="#" method="get">
                <div class="input-group">
                    <!-- USE TWITTER TYPEAHEAD JSON WITH API TO SEARCH -->
                    <input class="form-control" id="system-search" name="q" placeholder="Search for" required>
                    <span class="input-group-btn">
                        <button type="submit" class="btn btn-default" disabled><i class="glyphicon glyphicon-search"></i></button>
                    </span>
                </div>
            </form>
        </div>
        </div>
        <div class="row first-row">
        <div class="col-md-12">
                <table class="table table-list-search">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Name</th>
                            <th>Description</th>
                            <th>types</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for m in bodies %}
                        <tr>
                            <td>{{m.category}}</td>
                            <td>{{m.name}}</td>
                            <td>{{m.description}}</td>
                            <td>{% for c in m.pbtype.all %}
                                    {% if forloop.last %}
                                    {{c.name}}
                                    {% elif forloop.first %}
                                    {{c.name}}<br/>
                                    {% elif forloop.counter|divisibleby:2 %}
                                    {{c.name}},
                                    {% else %}
                                    {{c.name}},
                                    {% endif %} 
                                {% endfor %}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
        </div>

    <div class="hr5" style="margin-top:40px; margin-bottom:40px;"></div>
    </div>
<script type="text/javascript">
$(document).ready(function() {
    var activeSystemClass = $('.list-group-item.active');

    //something is entered in search form
    $('#system-search').keyup( function() {
       var that = this;
        // affect all table rows on in systems table
        var tableBody = $('.table-list-search tbody');
        var tableRowsClass = $('.table-list-search tbody tr');
        $('.search-sf').remove();
        tableRowsClass.each( function(i, val) {
        
            //Lower text for case insensitive
            var rowText = $(val).text().toLowerCase();
            var inputText = $(that).val().toLowerCase();
            if(inputText != '')
            {
                $('.search-query-sf').remove();
                tableBody.prepend('<tr class="search-query-sf"><td colspan="6"><strong>Searching for: "'
                    + $(that).val()
                    + '"</strong></td></tr>');
            }
            else
            {
                $('.search-query-sf').remove();
            }

            if( rowText.indexOf( inputText ) == -1 )
            {
                //hide rows
                tableRowsClass.eq(i).hide();
                
            }
            else
            {
                $('.search-sf').remove();
                tableRowsClass.eq(i).show();
            }
        });
        //all tr elements are hidden
        if(tableRowsClass.children(':visible').length == 0)
        {
            tableBody.append('<tr class="search-sf"><td class="text-muted" colspan="6">No entries found.</td></tr>');
        }
    });
});
</script>
{% endif %}

</div>


<style type="text/css">
#home-box > h2 { color: #eee; float:right;}
div.pagination { color: #eee; }
.price { font-size: 25px; float: left; }
.pricing_header { background: none repeat scroll 0% 0% rgb(204, 204, 204); border-radius: 5px 5px 0px 0px; transition: background 0.4s ease-out 0s; }
.pricing_header h2 { text-align:center; line-height: 25px; padding: 15px 0px; margin: 0px;  font-weight: 400; color: #000; }
.list-group-item:first-child { border-top-right-radius: 0px; border-top-left-radius: 0px; }
.btn { float: right;  font-weight:500;}
.on { color: rgb(86,86,86); }
.space {height: -25px; background-color: #000;}

.first-row {margin-left:1%;}
</style>
{% endblock %}